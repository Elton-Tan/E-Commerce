<script type="text/javascript" src="/js/piecharts.js"></script>
<script lang="javascript" src="/js/xlsx.full.min.js"></script>


  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@200&display=swap" rel="stylesheet">
    <style>
        
        .card .card-subtitle {
    font-weight: 300;
    margin-bottom: 10px;
    color: #a1aab2;
}
.card-subtitle {
    margin-top: -0.25rem;
  
}

h1, h2, h3, h4, h5, h6  {
  font-family:"Nunito Sans,sans-serif";
  font-family: var(--bs-font-sans-serif);
}

        
    </style>



<div class="row" >

    {{> _admin-sidebar }}


    <div class="col-sm-12 col-md-10">


        <div class="card">
                <div class="card-body">
                  <div class="d-md-flex align-items-center">
                    <div>
                      <h4 class="card-title" >Sales Summary</h4>
                      <h5 class="card-subtitle">Overview of Latest Month</h5>
                    </div>
                    <div class="ms-auto d-flex no-block align-items-center">

                        <button type="button" onclick="Download()" class="btn btn-primary">Export</button> <p>&#160;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
                        
                      <div class="dl">
                        <select class="form-select">
                          <option value="0" selected="">Monthly</option>
                          <option value="1">Daily</option>
                          <option value="2">Weekly</option>
                          <option value="3">Yearly</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  </div>

        <div class="row" style="margin-left: 1em;margin-top:1em">

            







            <div class="col-3">
                

            </div>
            



        </div>

        <div class="row margin-left: 1em;margin-top:1em ">


            

            




           
            <div class="col-2 ">
                    <div style="margin-left: 1em;" >
                      <div>
                        <h1 class="mb-0 mt-4">$502.28</h1>
                        <h6 class="fw-light text-muted">Current Month Earnings</h6>
                      </div>
                      <div>
                        <h3 class="mt-4 mb-0">20</h3>
                        <h6 class="fw-light text-muted mb-md-0 mt-md-2 mt-lg-0 mt-0">
                          Current Month Sales
                        </h6>
                      </div>
                    </div>
            </div>

        <div class="col-10">
                <div id="myChart" style="min-height: 265px;" width="826" height="250" ></div>
            </div>






        </div>

        


        <div class="card-body border-top">
                  <div class="row mb-0">
                    <!-- col -->
                    <div class="col-lg-3 col-md-6 mb-3 mb-lg-0">
                      <div class="d-flex align-items-center">
                        <div class="me-2">
                          <span class="text-orange display-5"><i class="ri-wallet-2-fill"></i></span>
                        </div>
                        <div>
                          <span>Total users</span>
                          <h3 class="font-medium mb-0" id="us"></h3 id="us" ></h3>
                        </div>
                      </div>
                    </div>
                    <!-- col -->
                    <!-- col -->
                    <div class="col-lg-3 col-md-6 mb-3 mb-lg-0">
                      <div class="d-flex align-items-center">
                        <div class="me-2">
                          <span class="text-cyan display-5"><i class="ri-money-cny-circle-fill"></i></span>
                        </div>
                        <div>
                          <span>Claimed promo</span>
                          <h3 class="font-medium mb-0">$59.08</h3>
                        </div>
                      </div>
                    </div>
                    <!-- col -->
                    <!-- col -->
                    <div class="col-lg-3 col-md-6 mb-3 mb-md-0">
                      <div class="d-flex align-items-center">
                        <div class="me-2">
                          <span class="text-info display-5"><i class="ri-shopping-bag-fill"></i></span>
                        </div>
                        <div>
                          <span>Orders</span>
                          <h3 class="font-medium mb-0">89</h3>
                        </div>
                      </div>
                    </div>
                    <!-- col -->
                    <!-- col -->
                    <div class="col-lg-3 col-md-6">
                      <div class="d-flex align-items-center">
                        <div class="me-2">
                          <span class="text-primary display-5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg></span>
                        </div>
                        <div>
                          <span>Earnings</span>
                          <h3 class="font-medium mb-0">$23,568.90</h3>
                        </div>
                      </div>
                    </div>
                    <!-- col -->
                  </div>
                </div>

    </div>
    

<br>
    <div class="row">
        
            <div class="col-lg-8 col-xl-6 d-flex align-items-stretch">
              <!-- ---------------------
                            start Email Campaigns
                        ---------------- -->
              <div class="card card-hover w-100">
                <div class="card-body">
                  <div class="d-md-flex align-items-center">
                    <div>
                      <h4 class="card-title">Material Popularity</h4>
                      <h5 class="card-subtitle">Overview of Material Popularity</h5>
                    </div>
                    <div class="ms-auto align-items-center">
                      <div class="dl">
                        <select class="form-select">
                          <option value="0" selected="">Monthly</option>
                          <option value="1">Daily</option>
                          <option value="2">Weekly</option>
                          <option value="3">Yearly</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <!-- column -->
                  <div class="row mt-5">
                    <!-- column -->
                    <div class="col-lg-6 d-flex justify-content-center align-items-center" style="position: relative;">
                      
                      
                       

                        
                         
                        
                      

                    <div class="resize-triggers"><div class="expand-trigger" id="piechart" ><div style="width: 309px; height: 218px;"></div></div><div class="contract-trigger"></div></div></div>
                    <!-- column (Open Ratio for Campaigns chart) -->
                        
                    
                    <div class="col-lg-6">
                        
                      <h1 class="display-6 mb-0 font-medium">&nbsp;</h1>
                      
                      <ul class="list-style-none">
                        <li class="mt-3 d-flex align-items-center">
                          <i class="ri-checkbox-blank-circle-fill fs-3 me-1 text-info fs-2"></i>
                          Cotton <span class="ms-auto">51%</span>
                        </li>
                        <li class="mt-3 d-flex align-items-center">
                          <i class="ri-checkbox-blank-circle-fill fs-3 me-1 text-info fs-2"></i>
                          Organic <span class="ms-auto">27.1%</span>
                        </li>
                        <li class="mt-3 d-flex align-items-center">
                          <i class="ri-checkbox-blank-circle-fill fs-3 me-1 text-orange fs-2"></i>
                          Nylon <span class="ms-auto">25%</span>
                        </li>
                        <li class="mt-3 d-flex align-items-center">
                          <i class="ri-checkbox-blank-circle-fill fs-3 me-1 text-primary fs-2"></i>
                          Silk <span class="ms-auto">17%</span>
                        </li>
                      </ul>
                    </div>
                  </div>
                  <!-- column -->
                </div>
              </div>
            
          
            </div>



 <div class="col-lg-8 col-xl-6 d-flex align-items-stretch">
              <!-- ---------------------
                            start Email Campaigns
                        ---------------- -->
                        
              <div class="card card-hover w-100">
                <div class="card-body" >
                  <div class="d-md-flex align-items-center">
                    <div>
                      <h4 class="card-title">Popular Dress</h4>
                      <h5 class="card-subtitle">Overview of Popular Dress</h5>
                    </div>
                  </div>
                  <!-- column -->
                  <div class="row mt-5">
                    <!-- column -->
                    <div class="col-lg-6 d-flex justify-content-center align-items-center" style="position: relative;">
                      
                      
                       

                        <div class="pt-3 text-left" style="font-size: 20px;">
 
                   
                    <!-- Progress -->
                   
                
                <li id="11"></li>
                <li id="12"></li>
                <li id="13"></li>

                     
                    <!-- Progress -->
                    <!-- row -->
                
                    
                  </div>
         
                  </div>
                  <!-- column -->
                </div>
              </div>
            
            </div>












            
            <div class="col-lg-4 col-xl-6 d-flex align-items-stretch">
              <!-- ---------------------
                            
                        ---------------- -->
              <div class="card w-100">
                <div class="card-body border-bottom" style="position: relative;">
                  <h4 class="card-title">Order Stats</h4>
                  <h5 class="card-subtitle">Overview of orders</h5>
                  <div class="order-stats mt-4 d-flex justify-content-center" style="min-height: 254.8px;"><div id="apexcharts73bsllmv" class="apexcharts-canvas apexcharts73bsllmv apexcharts-theme-light" style="width: 283px; height: 254.8px;"><svg id="SvgjsSvg1194" width="283" height="254.79999999999998" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" class="apexcharts-svg" xmlns:data="ApexChartsNS" transform="translate(0, 0)" style="background: transparent;"><g id="SvgjsG1196" class="apexcharts-inner apexcharts-graphical" transform="translate(29.5, 0)"><defs id="SvgjsDefs1195"><clipPath id="gridRectMask73bsllmv"><rect id="SvgjsRect1198" width="230" height="248" x="-2" y="0" rx="0" ry="0" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0" fill="#fff"></rect></clipPath><clipPath id="gridRectMarkerMask73bsllmv"><rect id="SvgjsRect1199" width="230" height="252" x="-2" y="-2" rx="0" ry="0" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0" fill="#fff"></rect></clipPath></defs><g id="SvgjsG1200" class="apexcharts-pie"><g id="SvgjsG1201" transform="translate(0, 0) scale(1)"><circle id="SvgjsCircle1202" r="87.73170731707317" cx="113" cy="124" fill="transparent"></circle><g id="SvgjsG1203" class="apexcharts-slices"><g id="SvgjsG1204" class="apexcharts-series apexcharts-pie-series" seriesName="Success" rel="1" data:realIndex="0"><path id="SvgjsPath1205" d="M 113.00000000000001 7.024390243902431 A 116.97560975609757 116.97560975609757 0 1 1 10.4570102819725 180.28701926287567 L 36.09275771147938 166.21526444715676 A 87.73170731707317 87.73170731707317 0 1 0 113 36.26829268292683 L 113.00000000000001 7.024390243902431 z" fill="rgba(79,195,247,1)" fill-opacity="1" stroke-opacity="1" stroke-linecap="butt" stroke-width="0" stroke-dasharray="0" class="apexcharts-pie-area apexcharts-donut-slice-0" index="0" j="0" data:angle="241.23711340206185" data:startAngle="0" data:strokeWidth="0" data:value="65" data:pathOrig="M 113.00000000000001 7.024390243902431 A 116.97560975609757 116.97560975609757 0 1 1 10.4570102819725 180.28701926287567 L 36.09275771147938 166.21526444715676 A 87.73170731707317 87.73170731707317 0 1 0 113 36.26829268292683 L 113.00000000000001 7.024390243902431 z"></path></g><g id="SvgjsG1206" class="apexcharts-series apexcharts-pie-series" seriesName="Failed" rel="2" data:realIndex="1"><path id="SvgjsPath1207" d="M 10.4570102819725 180.28701926287567 A 116.97560975609757 116.97560975609757 0 0 1 16.401057833106947 58.030782556952545 L 40.55079337483021 74.52308691771441 A 87.73170731707317 87.73170731707317 0 0 0 36.09275771147938 166.21526444715676 L 10.4570102819725 180.28701926287567 z" fill="rgba(251,140,0,1)" fill-opacity="1" stroke-opacity="1" stroke-linecap="butt" stroke-width="0" stroke-dasharray="0" class="apexcharts-pie-area apexcharts-donut-slice-1" index="0" j="1" data:angle="63.09278350515464" data:startAngle="241.23711340206185" data:strokeWidth="0" data:value="17" data:pathOrig="M 10.4570102819725 180.28701926287567 A 116.97560975609757 116.97560975609757 0 0 1 16.401057833106947 58.030782556952545 L 40.55079337483021 74.52308691771441 A 87.73170731707317 87.73170731707317 0 0 0 36.09275771147938 166.21526444715676 L 10.4570102819725 180.28701926287567 z"></path></g><g id="SvgjsG1208" class="apexcharts-series apexcharts-pie-series" seriesName="Pending" rel="3" data:realIndex="2"><path id="SvgjsPath1209" d="M 16.401057833106947 58.030782556952545 A 116.97560975609757 116.97560975609757 0 0 1 112.97958390475591 7.024392025542838 L 112.98468792856693 36.26829401915714 A 87.73170731707317 87.73170731707317 0 0 0 40.55079337483021 74.52308691771441 L 16.401057833106947 58.030782556952545 z" fill="rgba(41,98,255,1)" fill-opacity="1" stroke-opacity="1" stroke-linecap="butt" stroke-width="0" stroke-dasharray="0" class="apexcharts-pie-area apexcharts-donut-slice-2" index="0" j="2" data:angle="55.670103092783506" data:startAngle="304.3298969072165" data:strokeWidth="0" data:value="15" data:pathOrig="M 16.401057833106947 58.030782556952545 A 116.97560975609757 116.97560975609757 0 0 1 112.97958390475591 7.024392025542838 L 112.98468792856693 36.26829401915714 A 87.73170731707317 87.73170731707317 0 0 0 40.55079337483021 74.52308691771441 L 16.401057833106947 58.030782556952545 z"></path></g></g></g><g id="SvgjsG1210" class="apexcharts-datalabels-group" transform="translate(0, 0) scale(1)" style="opacity: 1;"><text id="SvgjsText1211" font-family="Helvetica, Arial, sans-serif" x="113" y="134" text-anchor="middle" dominant-baseline="auto" font-size="13px" font-weight="400" fill="#a1aab2" class="apexcharts-text apexcharts-datalabel-label" style="font-family: Helvetica, Arial, sans-serif; fill: rgb(161, 170, 178);">Orders</text></g></g><line id="SvgjsLine1212" x1="0" y1="0" x2="226" y2="0" stroke="#b6b6b6" stroke-dasharray="0" stroke-width="1" class="apexcharts-ycrosshairs"></line><line id="SvgjsLine1213" x1="0" y1="0" x2="226" y2="0" stroke-dasharray="0" stroke-width="0" class="apexcharts-ycrosshairs-hidden"></line></g><g id="SvgjsG1197" class="apexcharts-annotations"></g></svg><div class="apexcharts-legend"></div><div class="apexcharts-tooltip apexcharts-theme-dark" style="left: -5.26302px; top: 28.6042px;"><div class="apexcharts-tooltip-series-group apexcharts-active" style="display: flex;"><span class="apexcharts-tooltip-marker" style="background-color: rgb(251, 140, 0);"></span><div class="apexcharts-tooltip-text" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"><div class="apexcharts-tooltip-z-group"><span class="apexcharts-tooltip-text-z-label"></span><span class="apexcharts-tooltip-text-z-value"></span></div></div></div><div class="apexcharts-tooltip-series-group" style="display: none;"><span class="apexcharts-tooltip-marker" style="background-color: rgb(251, 140, 0);"></span><div class="apexcharts-tooltip-text" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"><div class="apexcharts-tooltip-y-group"><span class="apexcharts-tooltip-text-label">Failed: </span><span class="apexcharts-tooltip-text-value">17</span></div><div class="apexcharts-tooltip-z-group"><span class="apexcharts-tooltip-text-z-label"></span><span class="apexcharts-tooltip-text-z-value"></span></div></div></div><div class="apexcharts-tooltip-series-group" style="display: none;"><span class="apexcharts-tooltip-marker" style="background-color: rgb(251, 140, 0);"></span><div class="apexcharts-tooltip-text" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"><div class="apexcharts-tooltip-y-group"><span class="apexcharts-tooltip-text-label">Failed: </span><span class="apexcharts-tooltip-text-value">17</span></div><div class="apexcharts-tooltip-z-group"><span class="apexcharts-tooltip-text-z-label"></span><span class="apexcharts-tooltip-text-z-value"></span></div></div></div></div></div></div>
                <div class="resize-triggers"><div class="expand-trigger"></div><div class="contract-trigger"></div></div></div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-4">
                      <i class="ri-checkbox-blank-circle-fill fs-4 text-primary"></i>
                      <h3 class="mb-0 font-medium">589</h3>
                      <span>Success</span>
                    </div>
                    <div class="col-4">
                      <i class="ri-checkbox-blank-circle-fill fs-4 text-info"></i>
                      <h3 class="mb-0 font-medium">53</h3>
                      <span>Pending</span>
                    </div>
                    <div class="col-4">
                      <i class="ri-checkbox-blank-circle-fill fs-4 text-orange"></i>
                      <h3 class="mb-0 font-medium">76</h3>
                      <span>Failed</span>
                    </div>
                  </div>
                </div>
              </div>

        

                        
            </div>

            
          </div>





















</div>
</div>
<script type="text/javascript">

 async function  Download(){
        console.log("cki")
         await $.ajax({
            type: 'POST',
            url: '/api/reportsdetail',
            contentType: 'application/json',
            data: JSON.stringify({ name: 'reports' }),
            success: function (dataa) {
               const worksheet = XLSX.utils.json_to_sheet(dataa.sales);
          const workbook = XLSX.utils.book_new()
        XLSX.utils.book_append_sheet(workbook, worksheet, "SheetJS");
          XLSX.writeFile(workbook, "Reports"+ '.xlsx');
            }
        });

  }



    google.charts.load('current', { 'packages': ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);


    async function drawChart() {

        await $.ajax({
            type: 'POST',
            url: '/api/reportsdetail',
            contentType: 'application/json',
            data: JSON.stringify({ name: 'reports' }),
            success: function (datae) {
                console.log(datae.total_users.count);

                console.log(datae);

                document.getElementById("us").innerHTML = datae.total_users.count;
                document.getElementById("11").innerHTML = datae.top_dressed[0].Name;
                document.getElementById("12").innerHTML = datae.top_dressed[1].Name;
                document.getElementById("13").innerHTML = datae.top_dressed[2].Name;
                var piechartsdata = [["Name", "Material Popularity"]];
                datae.material_popularity.map((value, index) => {

                    piechartsdata.push(Object.values(value));


                });

                var data = google.visualization.arrayToDataTable(piechartsdata);


                var options = { 'title': 'Material Popularity', 'width': 300, 'height': 300 };


                var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                chart.draw(data, options);

                var chartsData = [["Month", "Sales"]];
                datae.sales.map((value, index) => {

                    chartsData.push(Object.values(value));


                });
                console.log(chartsData);


                var dataa = google.visualization.arrayToDataTable(chartsData);

                var options = {
                    title: 'Sales By Month'
                };

                var chart = new google.visualization.LineChart(document.getElementById('myChart'));
                chart.draw(dataa, options);









            }
        });



    }


  window.onload= function () {

		  
 document.getElementById('togglee').style.visibility = 'hidden';
	  }
	  








</script>






</div>
</div>
<script type="text/javascript">

 async function  Download(){
        console.log("cki")
         await $.ajax({
            type: 'POST',
            url: '/api/reportsdetail',
            contentType: 'application/json',
            data: JSON.stringify({ name: 'reports' }),
            success: function (dataa) {
               const worksheet = XLSX.utils.json_to_sheet(dataa.sales);
          const workbook = XLSX.utils.book_new()
        XLSX.utils.book_append_sheet(workbook, worksheet, "SheetJS");
          XLSX.writeFile(workbook, "Reports"+ '.xlsx');
            }
        });

  }



    google.charts.load('current', { 'packages': ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);


    async function drawChart() {

        await $.ajax({
            type: 'POST',
            url: '/api/reportsdetail',
            contentType: 'application/json',
            data: JSON.stringify({ name: 'reports' }),
            success: function (datae) {
                console.log(datae.total_users.count);

                console.log(datae);

                document.getElementById("us").innerHTML = datae.total_users.count;
                document.getElementById("11").innerHTML = datae.top_dressed[0].Name;
                document.getElementById("12").innerHTML = datae.top_dressed[1].Name;
                document.getElementById("13").innerHTML = datae.top_dressed[2].Name;
                var piechartsdata = [["Name", "Material Popularity"]];
                datae.material_popularity.map((value, index) => {

                    piechartsdata.push(Object.values(value));


                });

                var data = google.visualization.arrayToDataTable(piechartsdata);


                var options = { 'title': 'Material Popularity', 'width': 300, 'height': 300 };


                var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                chart.draw(data, options);

                var chartsData = [["Month", "Sales"]];
                datae.sales.map((value, index) => {

                    chartsData.push(Object.values(value));


                });
                console.log(chartsData);


                var dataa = google.visualization.arrayToDataTable(chartsData);

                var options = {
                    title: 'Sales By Month'
                };

                var chart = new google.visualization.ColumnChart(document.getElementById('myChart'));
                chart.draw(dataa, options);









            }
        });



    }


  window.onload= function () {

		  
 document.getElementById('togglee').style.visibility = 'hidden';
	  }
	  








</script>